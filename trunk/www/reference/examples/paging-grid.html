<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Jx.Grid Paging Test Page</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<script type="text/javascript" src="../../lib/mootools-core.js"></script>
<script type="text/javascript" src="../../lib/mootools-more.js"></script>
<script type="text/javascript" src="../../lib/jxlib.standalone.uncompressed.js"></script>
<script src="js/tests.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
var grid;
var panel;
var aboutDialog;
var pagingToolbar;

window.addEvent('load', function() {
  
    drawToolbar();
    drawGrid();
    
    window.addEvent('stylesheetChanged', function() {
        if (aboutDialog && aboutDialog.chrome) {
            aboutDialog.close();
            aboutDialog.chrome.dispose();
            aboutDialog.chrome = null;                
        }
    });
    
});
</script>
<script id="toolbarScript" type="text/javascript">
function drawToolbar() {
    //here we'll make a paging toolbar.
    pagingToolbar = new Class({

        Extends: Jx.Toolbar,

        options: {
            store: null,
            paginationOptions: {
                ignoreExpiration: true
            },
            parent: 'toolbarArea'
        },

        init: function () {
            this.parent();
            
            if ($defined(this.options.store)) {
                this.store = this.options.store;
            } else {
                //can't do anything without a store!
                return;
            }

            this.strategy = this.store.getStrategy('paginate');

            if (!$defined(this.strategy)) {
                //it didn't have the strategy so let's add it
                var full = this.store.getStrategy('full');
                if (full) { full.deactivate(); }
                this.strategy = new Jx.Store.Strategy.Paginate(this.options.paginationOptions);
                this.store.addStrategy(this.strategy);
            }

            this.store.addEvent('storeDataLoaded', this.updateToolbar.bind(this));
            
            
        },

        render: function () {
            //create the toolbar
            this.parent();

            this.counter = new Element('div', {
                html: 'Page: 1 of X',
                id: 'counter'
            });
            this.add( 
                new Jx.Button({
                  id: 'start',
                  label: '<<',
                  //image: 'images/asterisk_orange.png',
                  tooltip: 'jump to first page',
                  onClick: function() { 
                    this.strategy.setPage('first'); 
                  }.bind(this)
                }),
                new Jx.Button({
                  id: 'previous',
                  label: '<',
                  //image: 'images/asterisk_orange.png',
                  tooltip: 'previous page',
                  onClick: function() { 
                    this.strategy.setPage('previous'); 
                  }.bind(this)
                }),
                new Jx.Toolbar.Item(this.counter),
                new Jx.Button({
                  id: 'next',
                  label: '>',
                  //image: 'images/asterisk_orange.png',
                  tooltip: 'next page',
                  onClick: function() { 
                      this.strategy.setPage('next');
                  }.bind(this)
                }),
                new Jx.Button({
                  id: 'last',
                  label: '>>',
                  //image: 'images/asterisk_orange.png',
                  tooltip: 'jump to last page',
                  onClick: function() { 
                      this.strategy.setPage('last');
                  }.bind(this)
                })
            );
        },

        updateToolbar: function () {
            this.counter.set('html','Page ' + this.strategy.getPage() + ' of ' + this.strategy.getNumberOfPages());
            this.update();
        }
    });
    
}
</script>
<script id="gridScript" type="text/javascript">
function drawGrid() {
    var parser = new Jx.Store.Parser.JSON();
    var paginate = new Jx.Store.Strategy.Paginate({
        ignoreExpiration: true
    });
    var protocol = new Jx.Store.Protocol.Ajax({
        parser: parser,
        urls: {
            read: 'paging.php'
        }
    });
    var store = new Jx.Store({
        protocol: protocol,
        strategies: [paginate],
        record: Jx.Record
    });
    
  //setup Grid options
  var options = {
      parent: 'gridArea',
      row: {
          useHeaders: true,
          alternateRowColors: true,
          headerField: 'id',
          rowHeight: 20
      },
      columns: {
          headerRowHeight: 20,
          useHeaders: true,
          columns: [{
              header: null,
              modelField: 'id',
              width: 'auto',
              isEditable: false,
              isSortable: false,
              isResizable: true,
              isHidden: false,
              cssClass: '',
              formatter: null,
              name: 'header',
              dataType: 'numeric'
          },{
              header: 'Area',
              modelField: 'AREA',
              width: 'auto',
              isEditable: true,
              isSortable: true,
              isResizable: true,
              isHidden: false,
              cssClass: '',
              formatter: null,
              name: 'area',
              dataType: 'numeric'
          },{
              header: 'Perimeter',
              modelField: 'PERIMETER',
              width: 'auto',
              isEditable: false,
              isSortable: false,
              isResizable: true,
              isHidden: false,
              cssClass: '',
              formatter: null,
              name: 'perimeter',
              dataType: 'numeric'
          },{
              header: 'Popplace_',
              modelField: 'POPPLACE_',
              width: 'auto',
              isEditable: false,
              isSortable: false,
              isResizable: true,
              isHidden: false,
              cssClass: '',
              formatter: null,
              name: 'popplace',
              dataType: 'numeric'
          },{
              header: 'Popplace_I',
              modelField: 'POPPLACE_I',
              width: 'auto',
              isEditable: false,
              isSortable: false,
              isResizable: true,
              isHidden: false,
              cssClass: '',
              formatter: null,
              name: 'popplace-i',
              dataType: 'numeric'
          },{
              header: 'Unique Key',
              modelField: 'UNIQUE_KEY',
              width: 'auto',
              isEditable: false,
              isSortable: false,
              isResizable: true,
              isHidden: false,
              cssClass: '',
              formatter: null,
              name: 'uniqueKey',
              dataType: 'alphanumeric'
          },{
              header: 'Name',
              modelField: 'NAME',
              width: 'auto',
              isEditable: false,
              isSortable: false,
              isResizable: true,
              isHidden: false,
              cssClass: '',
              formatter: null,
              name: 'name',
              dataType: 'alphanumeric'
          },{
              header: 'Name_E',
              modelField: 'NAME_E',
              width: 'auto',
              isEditable: false,
              isSortable: false,
              isResizable: true,
              isHidden: false,
              cssClass: '',
              formatter: null,
              name: 'nameE',
              dataType: 'alphanumeric'
          },{
              header: 'Name_F',
              modelField: 'NAME_F',
              width: 'auto',
              isEditable: false,
              isSortable: false,
              isResizable: true,
              isHidden: false,
              cssClass: '',
              formatter: null,
              name: 'nameF',
              dataType: 'alphanumeric'
          },{
              header: 'Reg_Code',
              modelField: 'REG_CODE',
              width: 'auto',
              isEditable: false,
              isSortable: false,
              isResizable: true,
              isHidden: false,
              cssClass: '',
              formatter: null,
              name: 'regCode',
              dataType: 'numeric'
          },{
              header: 'NTS50',
              modelField: 'NTS50',
              width: 'auto',
              isEditable: false,
              isSortable: false,
              isResizable: true,
              isHidden: false,
              cssClass: '',
              formatter: null,
              name: 'nts50',
              dataType: 'alphanumeric'
          },{
              header: 'Latitude',
              modelField: 'LAT',
              width: 'auto',
              isEditable: false,
              isSortable: false,
              isResizable: true,
              isHidden: false,
              cssClass: '',
              formatter: null,
              name: 'latitude',
              dataType: 'numeric'
          },{
              header: 'Longitude',
              modelField: 'LONG',
              width: 'auto',
              isEditable: false,
              isSortable: false,
              isResizable: true,
              isHidden: false,
              cssClass: '',
              formatter: null,
              name: 'longitude',
              dataType: 'numeric'
          },{
              header: 'Sgd_Code',
              modelField: 'SGC_CODE',
              width: 'auto',
              isEditable: false,
              isSortable: false,
              isResizable: true,
              isHidden: false,
              cssClass: '',
              formatter: null,
              name: 'sgdCode',
              dataType: 'numeric'
          },{
              header: 'Capital',
              modelField: 'CAPITAL',
              width: 'auto',
              isEditable: false,
              isSortable: false,
              isResizable: true,
              isHidden: false,
              cssClass: '',
              formatter: null,
              name: 'capital',
              dataType: 'numeric'
          },{
              header: 'Pop_Range',
              modelField: 'POP_RANGE',
              width: 'auto',
              isEditable: false,
              isSortable: false,
              isResizable: true,
              isHidden: false,
              cssClass: '',
              formatter: null,
              name: 'popRange',
              dataType: 'numeric'
          }
         ]
      },
      model: store
  };
  //create grid
  var grid = new Jx.Grid(options);
  var tlb = new pagingToolbar({
      store: store
  });
  store.load();
  
  
  
}
</script>
<style>
    #counter {
        height: 16px;
        line-height: 16px;
        color: black;
        margin-top: 6px;
        margin-right: 2px;
        font-size: 11px;
        font-family: Arial,Verdana,sans-serif;
    }
</style>
</head>
<body>

  <h1>Jx.Grid Paging Toolbar Examples</h1>
  <p>API Reference: <a id="grid-js" href="javascript:void();" title="link to API Reference">Jx.Grid</a></p>
  <p>This example demonstrates using the grid with the paginate strategy to create a custom paging toolbar. 
  Please take note that this is a VERY rudimentary implementation. Developers would be responsible for expanding
  and implementing a toolbar to meet their needs. This is just a proof-of-concept.</p>
  <div id="toolbarArea" class="toolbarBox" style="width: 500px;"></div>
  <div id="gridArea" class="gridBox"></div>

</body>
</html>